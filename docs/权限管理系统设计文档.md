# 晓风开发平台 - 权限管理系统设计文档

## 一、系统概述

### 1.1 项目背景

晓风开发平台是一个**可配置的多工具SaaS平台**,旨在让非技术人员也能快速创建、部署和管理各类工具类产品(问卷调查、报名登记、信息采集等)。平台采用三端架构(Web管理后台、前端展示页面、小程序),需要实现精细化的权限管理,支持多租户隔离、工具级权限控制和动态配置能力。

**核心业务特点:**
- **多租户架构**: 多个企业共享平台,数据严格隔离
- **工具级权限**: 用户对不同工具有不同的操作权限(拥有者/编辑者/查看者)
- **动态配置**: 所有菜单、按钮、页面配置从后端下发,小程序无需审核即可更新
- **角色多样化**: 平台管理员、工具运营者、终端用户、开发者等多种角色

### 1.2 技术栈

- **后端框架**: Spring Boot 2.7.0 + Java 17
- **安全框架**: Spring Security + JWT
- **ORM框架**: MyBatis-Plus
- **数据库**: MySQL 8.0
- **缓存**: Redis
- **文件存储**: 阿里云OSS/腾讯云COS
- **文档**: smart-doc

### 1.3 现有架构优势

项目已具备完整的JWT认证基础设施:
- JWT Token生成、验证、刷新机制
- AccessToken支持roles和permissions字段
- Spring Security全局方法级安全配置
- 基于ThreadLocal的请求上下文管理(Access类)
- 支持多种Token类型(app/user/ldap/oauth)

### 1.4 设计目标

1. **完整的RBAC+工具级权限模型**: 用户-角色-权限 + 用户-工具-角色
2. **多租户数据隔离**: 企业级数据隔离,防止数据泄露
3. **三端统一权限控制**: Web、小程序、管理后台权限联动
4. **动态菜单和页面配置**: 前端所有界面元素由后端控制
5. **工具协作权限**: 支持工具创建者、协作编辑者、数据查看者等角色
6. **细粒度数据权限**: 工具数据按创建者、团队、租户隔离

---

## 二、整体架构设计

### 2.1 系统架构图

```
┌─────────────────────────────────────────────────────────────┐
│                       客户端层                               │
├──────────────┬──────────────┬──────────────────────────────┤
│   Web管理后台 │  前端展示页面 │      小程序端                │
│ (运营/管理员) │  (终端用户)   │    (终端用户)                │
└──────┬───────┴──────┬───────┴──────────────┬───────────────┘
       │              │                      │
       └──────────────┴──────────────────────┘
                      │
              ┌───────▼────────┐
              │  Nginx/网关    │
              │  CORS/限流     │
              └───────┬────────┘
                      │
       ┌──────────────▼──────────────────┐
       │      Spring Security           │
       │  TokenAuthenticationFilter     │
       │   (JWT验证 + 租户识别)          │
       └──────────────┬──────────────────┘
                      │
       ┌──────────────▼──────────────────┐
       │       Controller层             │
       │  @PreAuthorize + 工具权限校验  │
       └──────────────┬──────────────────┘
                      │
       ┌──────────────▼──────────────────┐
       │        Service层               │
       │   业务逻辑 + 多租户过滤        │
       └──────────────┬──────────────────┘
                      │
       ┌──────────────▼──────────────────┐
       │    MyBatis-Plus拦截器          │
       │    (自动添加租户ID过滤)         │
       └──────────────┬──────────────────┘
                      │
       ┌──────────────▼──────────────────┐
       │         MySQL数据库             │
       │  租户/用户/角色/工具/权限表     │
       └─────────────────────────────────┘
```

### 2.2 权限模型架构

```
晓风平台权限模型 = RBAC(系统级) + ABAC(工具级)

系统级权限(RBAC):
  用户 ──n:m── 角色 ──n:m── 权限
   │                         │
   └─────────────────────────┴─→ 系统功能访问控制

工具级权限(ABAC):
  用户 ──n:m── 工具 ──n:m── 工具角色
   │                         │
   └─────────────────────────┴─→ 工具数据访问控制

租户隔离:
  租户(Tenant)
   ├─ 用户(Users)
   ├─ 工具(Tools)
   ├─ 模板(Templates)
   └─ 数据(Submissions)
```

---

## 三、用户角色体系

### 3.1 角色定义

| 角色编码 | 角色名称 | 适用范围 | 主要职责 | 典型权限 |
|---------|---------|---------|---------|---------|
| **super_admin** | 超级管理员 | 平台级 | 平台运维、租户管理、系统配置 | 所有权限,跨租户访问 |
| **tenant_admin** | 租户管理员 | 租户级 | 租户内用户管理、角色分配、工具审核 | 租户内所有工具和数据 |
| **tool_creator** | 工具创建者 | 租户级 | 创建工具、配置模板、管理自己的工具 | 创建工具、编辑自己的工具、查看数据 |
| **tool_operator** | 工具运营者 | 工具级 | 运营工具、查看数据、导出报表 | 查看指定工具数据、导出数据 |
| **data_viewer** | 数据查看者 | 工具级 | 仅查看工具数据 | 只读访问工具数据 |
| **end_user** | 终端用户 | 公开 | 使用工具、提交数据 | 访问公开工具、提交表单 |
| **developer** | 开发者 | 租户级 | 扩展组件、API集成 | 访问API、创建自定义组件 |

### 3.2 角色权限映射

#### 3.2.1 平台管理员(super_admin)

**系统权限:**
```
- platform:tenant:*        (租户管理:增删改查)
- platform:user:*          (全局用户管理)
- platform:template:*      (全局模板管理)
- platform:system:*        (系统配置、监控)
- platform:audit:*         (审计日志查看)
```

**特殊能力:**
- 跨租户访问数据(仅用于支持和审计)
- 创建和删除租户
- 全局模板发布

#### 3.2.2 租户管理员(tenant_admin)

**系统权限:**
```
- tenant:user:*            (租户内用户管理)
- tenant:role:assign       (角色分配)
- tenant:tool:*            (所有工具管理)
- tenant:template:*        (租户模板管理)
- tenant:data:export       (批量导出数据)
- tenant:stat:view         (租户统计查看)
```

**数据范围:** 本租户所有数据

#### 3.2.3 工具创建者(tool_creator)

**系统权限:**
```
- tool:create              (创建工具)
- tool:template:use        (使用模板)
- tool:config:edit         (配置工具)
- tool:publish             (发布工具)
- tool:data:view           (查看工具数据)
- tool:data:export         (导出数据)
- tool:member:manage       (管理协作成员)
```

**数据范围:** 自己创建的工具 + 被授权的工具

#### 3.2.4 工具运营者(tool_operator)

**工具权限:**
```
- tool:config:edit         (编辑工具配置)
- tool:data:view           (查看数据)
- tool:data:export         (导出数据)
- tool:stat:view           (查看统计)
```

**数据范围:** 被授权的工具

#### 3.2.5 数据查看者(data_viewer)

**工具权限:**
```
- tool:data:view           (仅查看数据)
- tool:stat:view           (查看统计)
```

**数据范围:** 被授权的工具(只读)

#### 3.2.6 终端用户(end_user)

**公开权限:**
```
- tool:public:access       (访问公开工具)
- tool:submit              (提交数据)
- tool:my:view             (查看自己的提交)
- tool:my:edit             (编辑自己的提交,需工具允许)
```

---

## 四、数据库设计

### 4.1 ER图关系

```
┌──────────┐        ┌──────────┐        ┌──────────┐
│ t_tenant │───1:n──│  t_user  │───n:m──│  t_role  │
└──────────┘        └─────┬────┘        └─────┬────┘
                          │                    │
                          │ n:m                │ n:m
                          │                    │
                    ┌─────▼────┐        ┌─────▼──────┐
                    │ t_tool   │───n:m──│t_permission│
                    └─────┬────┘        └────────────┘
                          │
                          │ 1:n
                    ┌─────▼──────┐
                    │t_submission│ (工具提交数据)
                    └────────────┘

┌──────────┐        ┌──────────┐
│t_template│───1:n──│t_tool    │
└──────────┘        └──────────┘

┌──────────┐        ┌──────────┐
│  t_menu  │───n:m──│t_permission│
└──────────┘        └────────────┘
```

### 4.2 核心表结构

#### 4.2.1 租户表(t_tenant)

```sql
CREATE TABLE `t_tenant` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `tenant_code` VARCHAR(50) NOT NULL COMMENT '租户编码(唯一标识)',
  `tenant_name` VARCHAR(100) NOT NULL COMMENT '租户名称',
  `domain` VARCHAR(100) COMMENT '独立域名',
  `logo` VARCHAR(500) COMMENT 'Logo URL',
  `contact_name` VARCHAR(50) COMMENT '联系人姓名',
  `contact_phone` VARCHAR(20) COMMENT '联系电话',
  `contact_email` VARCHAR(100) COMMENT '联系邮箱',
  `max_users` INT(11) DEFAULT 100 COMMENT '最大用户数',
  `max_tools` INT(11) DEFAULT 50 COMMENT '最大工具数',
  `max_storage` BIGINT(20) DEFAULT 10737418240 COMMENT '最大存储空间(字节,默认10G)',
  `expire_date` DATE COMMENT '到期时间',
  `status` TINYINT(1) NOT NULL DEFAULT 1 COMMENT '状态: 0-禁用, 1-正常, 2-试用, 3-过期',
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `deleted` TINYINT(1) NOT NULL DEFAULT 0 COMMENT '逻辑删除',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_tenant_code` (`tenant_code`),
  UNIQUE KEY `uk_domain` (`domain`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='租户表';
```

#### 4.2.2 用户表(t_user) - 增强版

```sql
CREATE TABLE `t_user` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `tenant_id` BIGINT(20) NOT NULL COMMENT '租户ID',
  `username` VARCHAR(50) NOT NULL COMMENT '用户名(登录账号)',
  `password` VARCHAR(100) COMMENT '密码(BCrypt加密,终端用户可为空)',
  `nickname` VARCHAR(50) COMMENT '昵称',
  `real_name` VARCHAR(50) COMMENT '真实姓名',
  `phone` VARCHAR(20) COMMENT '手机号',
  `email` VARCHAR(100) COMMENT '邮箱',
  `avatar` VARCHAR(500) COMMENT '头像URL',
  `user_type` VARCHAR(20) NOT NULL DEFAULT 'end_user' COMMENT '用户类型: tenant_admin, tool_creator, end_user, developer',
  `platform` VARCHAR(20) NOT NULL DEFAULT 'web' COMMENT '注册平台: web, miniapp, admin',
  `wx_openid` VARCHAR(100) COMMENT '微信OpenID',
  `wx_unionid` VARCHAR(100) COMMENT '微信UnionID',
  `status` TINYINT(1) NOT NULL DEFAULT 1 COMMENT '状态: 0-禁用, 1-启用',
  `last_login_time` DATETIME COMMENT '最后登录时间',
  `last_login_ip` VARCHAR(50) COMMENT '最后登录IP',
  `create_by` BIGINT(20) COMMENT '创建人ID',
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `deleted` TINYINT(1) NOT NULL DEFAULT 0,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_tenant_username` (`tenant_id`, `username`),
  UNIQUE KEY `uk_phone` (`phone`),
  UNIQUE KEY `uk_wx_openid` (`wx_openid`),
  KEY `idx_tenant_id` (`tenant_id`),
  KEY `idx_user_type` (`user_type`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户表';
```

#### 4.2.3 工具表(t_tool) - 核心业务表

```sql
CREATE TABLE `t_tool` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `tenant_id` BIGINT(20) NOT NULL COMMENT '租户ID',
  `tool_code` VARCHAR(50) NOT NULL COMMENT '工具编码(URL友好)',
  `tool_name` VARCHAR(100) NOT NULL COMMENT '工具名称',
  `tool_desc` VARCHAR(500) COMMENT '工具描述',
  `tool_icon` VARCHAR(500) COMMENT '工具图标URL',
  `category` VARCHAR(50) COMMENT '分类: survey(问卷), registration(报名), collection(采集)',
  `template_id` BIGINT(20) COMMENT '基于的模板ID',

  -- 配置信息(JSON格式)
  `config_json` TEXT COMMENT '工具配置JSON(字段、验证规则、样式等)',
  `style_json` TEXT COMMENT '样式配置JSON(主题色、背景、布局等)',

  -- 访问控制
  `access_type` TINYINT(1) NOT NULL DEFAULT 1 COMMENT '访问类型: 1-公开, 2-密码, 3-登录',
  `access_password` VARCHAR(100) COMMENT '访问密码(MD5)',
  `submit_limit` INT(11) DEFAULT 0 COMMENT '提交次数限制(0-不限)',
  `allow_edit` TINYINT(1) DEFAULT 0 COMMENT '是否允许编辑已提交数据',

  -- 状态
  `status` TINYINT(1) NOT NULL DEFAULT 0 COMMENT '状态: 0-草稿, 1-已发布, 2-已关闭',
  `publish_time` DATETIME COMMENT '发布时间',
  `close_time` DATETIME COMMENT '关闭时间',

  -- 统计
  `view_count` INT(11) DEFAULT 0 COMMENT '访问次数',
  `submit_count` INT(11) DEFAULT 0 COMMENT '提交次数',

  -- 元数据
  `creator_id` BIGINT(20) NOT NULL COMMENT '创建人ID',
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `update_by` BIGINT(20),
  `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `deleted` TINYINT(1) NOT NULL DEFAULT 0,

  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_tenant_code` (`tenant_id`, `tool_code`),
  KEY `idx_tenant_id` (`tenant_id`),
  KEY `idx_creator_id` (`creator_id`),
  KEY `idx_status` (`status`),
  KEY `idx_category` (`category`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工具表';
```

**config_json示例:**
```json
{
  "fields": [
    {
      "id": "f1",
      "type": "text",
      "label": "姓名",
      "required": true,
      "placeholder": "请输入您的姓名",
      "maxLength": 50
    },
    {
      "id": "f2",
      "type": "select",
      "label": "性别",
      "required": true,
      "options": ["男", "女", "其他"]
    },
    {
      "id": "f3",
      "type": "upload",
      "label": "上传照片",
      "maxSize": 2048,
      "accept": ["jpg", "png"]
    }
  ],
  "settings": {
    "showProgress": true,
    "submitText": "提交",
    "successMessage": "提交成功！"
  }
}
```

#### 4.2.4 工具模板表(t_template)

```sql
CREATE TABLE `t_template` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `template_code` VARCHAR(50) NOT NULL COMMENT '模板编码',
  `template_name` VARCHAR(100) NOT NULL COMMENT '模板名称',
  `template_desc` VARCHAR(500) COMMENT '模板描述',
  `category` VARCHAR(50) COMMENT '分类',
  `icon` VARCHAR(500) COMMENT '图标URL',
  `preview_image` VARCHAR(500) COMMENT '预览图URL',
  `config_json` TEXT COMMENT '默认配置JSON',
  `style_json` TEXT COMMENT '默认样式JSON',
  `scope` TINYINT(1) NOT NULL DEFAULT 1 COMMENT '范围: 1-全局, 2-租户',
  `tenant_id` BIGINT(20) COMMENT '租户ID(租户模板时填写)',
  `use_count` INT(11) DEFAULT 0 COMMENT '使用次数',
  `sort_order` INT(11) DEFAULT 0 COMMENT '排序',
  `status` TINYINT(1) NOT NULL DEFAULT 1 COMMENT '状态: 0-禁用, 1-启用',
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `deleted` TINYINT(1) NOT NULL DEFAULT 0,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_template_code` (`template_code`),
  KEY `idx_category` (`category`),
  KEY `idx_scope_tenant` (`scope`, `tenant_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工具模板表';
```

#### 4.2.5 工具提交数据表(t_submission)

```sql
CREATE TABLE `t_submission` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `tenant_id` BIGINT(20) NOT NULL COMMENT '租户ID',
  `tool_id` BIGINT(20) NOT NULL COMMENT '工具ID',
  `data_json` TEXT NOT NULL COMMENT '提交的数据JSON',
  `submit_user_id` BIGINT(20) COMMENT '提交用户ID(已登录用户)',
  `submit_ip` VARCHAR(50) COMMENT '提交IP',
  `submit_device` VARCHAR(100) COMMENT '提交设备',
  `submit_platform` VARCHAR(20) COMMENT '提交平台: web, miniapp',
  `status` TINYINT(1) DEFAULT 1 COMMENT '状态: 1-正常, 2-已审核, 3-已拒绝',
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '提交时间',
  `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `deleted` TINYINT(1) NOT NULL DEFAULT 0,
  PRIMARY KEY (`id`),
  KEY `idx_tenant_tool` (`tenant_id`, `tool_id`),
  KEY `idx_tool_id` (`tool_id`),
  KEY `idx_submit_user` (`submit_user_id`),
  KEY `idx_create_time` (`create_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工具提交数据表';
```

**data_json示例:**
```json
{
  "f1": "张三",
  "f2": "男",
  "f3": "https://oss.example.com/photos/abc123.jpg"
}
```

#### 4.2.6 工具协作者表(t_tool_member)

```sql
CREATE TABLE `t_tool_member` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `tool_id` BIGINT(20) NOT NULL COMMENT '工具ID',
  `user_id` BIGINT(20) NOT NULL COMMENT '用户ID',
  `role` VARCHAR(20) NOT NULL COMMENT '工具角色: owner(拥有者), editor(编辑者), viewer(查看者)',
  `permissions` VARCHAR(500) COMMENT '工具权限(JSON数组): ["data:view", "data:export", "config:edit"]',
  `invite_by` BIGINT(20) COMMENT '邀请人ID',
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_tool_user` (`tool_id`, `user_id`),
  KEY `idx_user_id` (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工具协作者表';
```

#### 4.2.7 角色表(t_role) - 调整版

```sql
CREATE TABLE `t_role` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `tenant_id` BIGINT(20) COMMENT '租户ID(全局角色为NULL)',
  `role_code` VARCHAR(50) NOT NULL COMMENT '角色编码',
  `role_name` VARCHAR(50) NOT NULL COMMENT '角色名称',
  `role_level` TINYINT(1) NOT NULL DEFAULT 2 COMMENT '角色级别: 1-平台级, 2-租户级, 3-工具级',
  `platform` VARCHAR(20) DEFAULT 'all' COMMENT '适用平台: all, web, miniapp, admin',
  `sort_order` INT(11) DEFAULT 0,
  `status` TINYINT(1) NOT NULL DEFAULT 1,
  `remark` VARCHAR(500),
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `deleted` TINYINT(1) NOT NULL DEFAULT 0,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_tenant_code` (`tenant_id`, `role_code`),
  KEY `idx_role_level` (`role_level`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='角色表';
```

**预设角色数据:**
```sql
INSERT INTO t_role (tenant_id, role_code, role_name, role_level, platform) VALUES
(NULL, 'super_admin', '超级管理员', 1, 'admin'),
(NULL, 'tenant_admin', '租户管理员', 2, 'admin'),
(NULL, 'tool_creator', '工具创建者', 2, 'all'),
(NULL, 'tool_operator', '工具运营者', 3, 'all'),
(NULL, 'data_viewer', '数据查看者', 3, 'all'),
(NULL, 'end_user', '终端用户', 2, 'all'),
(NULL, 'developer', '开发者', 2, 'all');
```

#### 4.2.8 权限表(t_permission)

```sql
CREATE TABLE `t_permission` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `perm_code` VARCHAR(100) NOT NULL COMMENT '权限编码',
  `perm_name` VARCHAR(50) NOT NULL COMMENT '权限名称',
  `perm_type` VARCHAR(20) NOT NULL COMMENT '权限类型: menu, button, api',
  `resource_url` VARCHAR(200) COMMENT '资源URL(API路径)',
  `method` VARCHAR(10) COMMENT 'HTTP方法',
  `parent_id` BIGINT(20) COMMENT '父权限ID',
  `platform` VARCHAR(20) DEFAULT 'all',
  `sort_order` INT(11) DEFAULT 0,
  `status` TINYINT(1) NOT NULL DEFAULT 1,
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `deleted` TINYINT(1) NOT NULL DEFAULT 0,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_perm_code` (`perm_code`),
  KEY `idx_perm_type` (`perm_type`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='权限表';
```

**权限编码规范:**
```
平台级:
- platform:tenant:*         (租户管理)
- platform:user:*           (用户管理)
- platform:template:*       (模板管理)
- platform:system:*         (系统配置)

租户级:
- tenant:user:*             (租户用户管理)
- tenant:tool:*             (工具管理)
- tenant:template:*         (租户模板)
- tenant:data:export        (批量导出)

工具级:
- tool:create               (创建工具)
- tool:config:edit          (编辑配置)
- tool:publish              (发布工具)
- tool:data:view            (查看数据)
- tool:data:export          (导出数据)
- tool:member:manage        (成员管理)
```

#### 4.2.9 菜单表(t_menu)

```sql
CREATE TABLE `t_menu` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `menu_code` VARCHAR(50) NOT NULL COMMENT '菜单编码',
  `menu_name` VARCHAR(50) NOT NULL COMMENT '菜单名称',
  `parent_id` BIGINT(20) DEFAULT 0 COMMENT '父菜单ID',
  `menu_type` TINYINT(1) NOT NULL COMMENT '菜单类型: 1-目录, 2-菜单, 3-按钮',
  `path` VARCHAR(200) COMMENT '路由路径',
  `component` VARCHAR(200) COMMENT '组件路径',
  `icon` VARCHAR(100) COMMENT '图标',
  `platform` VARCHAR(20) NOT NULL DEFAULT 'admin' COMMENT '平台: admin, web, miniapp',
  `visible` TINYINT(1) NOT NULL DEFAULT 1,
  `sort_order` INT(11) DEFAULT 0,
  `status` TINYINT(1) NOT NULL DEFAULT 1,
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `deleted` TINYINT(1) NOT NULL DEFAULT 0,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_menu_code` (`menu_code`),
  KEY `idx_parent_id` (`parent_id`),
  KEY `idx_platform` (`platform`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='菜单表';
```

**菜单示例数据:**
```sql
-- 管理后台菜单
INSERT INTO t_menu (menu_code, menu_name, parent_id, menu_type, path, icon, platform, sort_order) VALUES
('dashboard', '工作台', 0, 2, '/dashboard', 'dashboard', 'admin', 1),
('tool_manage', '工具管理', 0, 1, '/tool', 'tool', 'admin', 2),
('tool_list', '我的工具', 2, 2, '/tool/list', NULL, 'admin', 1),
('tool_create', '创建工具', 2, 2, '/tool/create', NULL, 'admin', 2),
('template_market', '模板市场', 2, 2, '/tool/template', NULL, 'admin', 3),
('data_manage', '数据管理', 0, 1, '/data', 'database', 'admin', 3),
('stat_report', '统计报表', 0, 2, '/stat', 'chart', 'admin', 4),
('system', '系统管理', 0, 1, '/system', 'setting', 'admin', 10),
('system_user', '用户管理', 9, 2, '/system/user', NULL, 'admin', 1),
('system_role', '角色管理', 9, 2, '/system/role', NULL, 'admin', 2);
```

#### 4.2.10 关联表

```sql
-- 用户角色关联表
CREATE TABLE `t_user_role` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT,
  `user_id` BIGINT(20) NOT NULL,
  `role_id` BIGINT(20) NOT NULL,
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_user_role` (`user_id`, `role_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户角色关联表';

-- 角色权限关联表
CREATE TABLE `t_role_permission` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT,
  `role_id` BIGINT(20) NOT NULL,
  `permission_id` BIGINT(20) NOT NULL,
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_role_perm` (`role_id`, `permission_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='角色权限关联表';

-- 菜单权限关联表
CREATE TABLE `t_menu_permission` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT,
  `menu_id` BIGINT(20) NOT NULL,
  `permission_id` BIGINT(20) NOT NULL,
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_menu_perm` (`menu_id`, `permission_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='菜单权限关联表';
```

---

## 五、多租户隔离方案

### 5.1 租户识别机制

**方案一: 基于域名识别(推荐)**

```
租户A: tenant-a.xiaofeng.com
租户B: tenant-b.xiaofeng.com
平台: admin.xiaofeng.com

Nginx配置:
location / {
    proxy_set_header X-Tenant-Domain $host;
    proxy_pass http://backend;
}

后端解析:
String domain = request.getHeader("X-Tenant-Domain");
Tenant tenant = tenantService.getByDomain(domain);
Access.setTenantId(tenant.getId());
```

**方案二: 基于Token识别**

```java
// 登录时将租户ID写入Token
AccessToken token = new AccessToken();
token.setTenantId(user.getTenantId());
String jwt = tokenService.newToken(token);

// 请求时从Token中提取
AccessToken token = tokenService.parseToken(request);
Long tenantId = token.getTenantId();
Access.setTenantId(tenantId);
```

### 5.2 数据隔离实现

#### 5.2.1 MyBatis-Plus租户拦截器

```java
/**
 * 多租户拦截器
 */
@Configuration
public class MybatisPlusConfig {

    @Bean
    public MybatisPlusInterceptor mybatisPlusInterceptor() {
        MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();

        // 租户拦截器
        TenantLineInnerInterceptor tenantInterceptor = new TenantLineInnerInterceptor();
        tenantInterceptor.setTenantLineHandler(new TenantLineHandler() {
            @Override
            public Expression getTenantId() {
                Long tenantId = Access.tenantId();
                if (tenantId == null) {
                    throw new BizException("租户信息缺失");
                }
                return new LongValue(tenantId);
            }

            @Override
            public boolean ignoreTable(String tableName) {
                // 不需要租户隔离的表
                List<String> ignoreTables = Arrays.asList(
                    "t_tenant", "t_role", "t_permission", "t_menu"
                );
                return ignoreTables.contains(tableName);
            }
        });

        interceptor.addInnerInterceptor(tenantInterceptor);
        return interceptor;
    }
}
```

**拦截效果:**
```sql
-- 原始SQL
SELECT * FROM t_user WHERE username = 'test';

-- 拦截后SQL
SELECT * FROM t_user WHERE username = 'test' AND tenant_id = 123;
```

#### 5.2.2 超级管理员跨租户访问

```java
@Service
public class UserService {

    /**
     * 超级管理员查询指定租户用户
     */
    @IgnoreTenant  // 自定义注解,临时忽略租户拦截
    public List<User> getUsersByTenantId(Long tenantId) {
        // 检查当前用户是否为超级管理员
        if (!Access.isSuperAdmin()) {
            throw new BizException("无权访问");
        }

        return userMapper.selectList(
            new LambdaQueryWrapper<User>()
                .eq(User::getTenantId, tenantId)
        );
    }
}
```

---

## 六、工具级权限控制

### 6.1 工具权限模型

```
工具权限 = 工具所有权 + 协作权限

工具所有权:
  创建者自动成为工具owner,拥有所有权限

协作权限:
  owner可以邀请其他用户成为:
  - editor(编辑者): 可编辑配置、查看数据
  - viewer(查看者): 仅查看数据

权限检查:
  1. 检查用户是否为租户管理员(有全部工具权限)
  2. 检查用户是否为工具creator
  3. 检查t_tool_member表中的协作权限
```

### 6.2 工具权限检查实现

```java
/**
 * 工具权限检查注解
 */
@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface RequireToolPermission {
    String value(); // 工具ID参数名
    String[] permissions(); // 需要的权限: owner, editor, viewer
}

/**
 * 工具权限切面
 */
@Aspect
@Component
public class ToolPermissionAspect {

    @Around("@annotation(requireToolPermission)")
    public Object checkToolPermission(ProceedingJoinPoint point,
                                     RequireToolPermission requireToolPermission) throws Throwable {
        // 1. 获取工具ID
        Long toolId = getToolIdFromArgs(point, requireToolPermission.value());

        // 2. 检查租户ID匹配
        Tool tool = toolService.getById(toolId);
        if (!tool.getTenantId().equals(Access.tenantId())) {
            throw new BizException("无权访问该工具");
        }

        // 3. 检查工具权限
        if (!hasToolPermission(toolId, Access.userId(), requireToolPermission.permissions())) {
            throw new BizException("无该工具操作权限");
        }

        return point.proceed();
    }

    private boolean hasToolPermission(Long toolId, Long userId, String[] requiredPerms) {
        // 租户管理员有所有权限
        if (Access.hasRole("tenant_admin")) {
            return true;
        }

        // 检查工具成员表
        ToolMember member = toolMemberService.getOne(
            new LambdaQueryWrapper<ToolMember>()
                .eq(ToolMember::getToolId, toolId)
                .eq(ToolMember::getUserId, userId)
        );

        if (member == null) {
            return false;
        }

        // 检查角色
        String userRole = member.getRole();
        for (String requiredPerm : requiredPerms) {
            if (userRole.equals(requiredPerm) || userRole.equals("owner")) {
                return true;
            }
        }

        return false;
    }
}
```

**使用示例:**
```java
@RestController
@RequestMapping("/tool")
public class ToolController {

    /**
     * 编辑工具配置(需要owner或editor权限)
     */
    @PostMapping("/config/edit")
    @RequireToolPermission(value = "toolId", permissions = {"owner", "editor"})
    public R<Void> editConfig(@RequestBody ToolConfigDTO dto) {
        toolService.updateConfig(dto);
        return R.ok();
    }

    /**
     * 查看工具数据(需要owner、editor或viewer权限)
     */
    @GetMapping("/data/list")
    @RequireToolPermission(value = "toolId", permissions = {"owner", "editor", "viewer"})
    public R<List<SubmissionVO>> getDataList(@RequestParam Long toolId,
                                              @RequestParam Integer page) {
        return R.ok(submissionService.list(toolId, page));
    }
}
```

---

## 七、多端登录和动态配置

### 7.1 管理后台登录

```java
@PostMapping("/auth/admin/login")
public R<AdminLoginVO> adminLogin(@RequestBody AdminLoginDTO dto) {
    // 1. 验证用户名密码
    User user = userService.getByUsername(dto.getUsername());
    if (!passwordEncoder.matches(dto.getPassword(), user.getPassword())) {
        throw new BizException("用户名或密码错误");
    }

    // 2. 检查是否有管理后台访问权限
    List<String> roles = roleService.getRoleCodesByUserId(user.getId());
    if (!hasAdminRole(roles)) {
        throw new BizException("无管理后台访问权限");
    }

    // 3. 查询权限
    List<String> permissions = permissionService.getPermCodesByUserId(user.getId());

    // 4. 生成Token
    AccessToken token = new AccessToken();
    token.setUserId(user.getId());
    token.setTenantId(user.getTenantId());
    token.setRoles(roles);
    token.setPermissions(permissions);
    String jwt = tokenService.newToken(token);

    // 5. 查询管理后台菜单树
    List<MenuTreeVO> menus = menuService.getMenuTree(roles, "admin");

    // 6. 查询工具统计
    ToolStatVO toolStat = toolService.getStat(user.getTenantId());

    return R.ok(new AdminLoginVO(jwt, user, menus, permissions, toolStat));
}
```

**返回数据结构:**
```json
{
  "code": 200,
  "data": {
    "token": "eyJhbGc...",
    "userInfo": {
      "id": 123,
      "username": "admin",
      "nickname": "管理员",
      "avatar": "https://...",
      "tenantId": 10,
      "tenantName": "某某企业"
    },
    "menus": [
      {
        "id": 1,
        "menuCode": "dashboard",
        "menuName": "工作台",
        "path": "/dashboard",
        "icon": "dashboard",
        "children": []
      },
      {
        "id": 2,
        "menuCode": "tool_manage",
        "menuName": "工具管理",
        "icon": "tool",
        "children": [
          {
            "id": 3,
            "menuCode": "tool_list",
            "menuName": "我的工具",
            "path": "/tool/list",
            "component": "views/tool/List"
          }
        ]
      }
    ],
    "permissions": [
      "tool:create",
      "tool:config:edit",
      "tool:data:view"
    ],
    "stat": {
      "totalTools": 15,
      "publishedTools": 12,
      "totalSubmissions": 3580,
      "todaySubmissions": 125
    }
  }
}
```

### 7.2 小程序登录

```java
@PostMapping("/auth/miniapp/login")
public R<MiniAppLoginVO> miniAppLogin(@RequestBody MiniAppLoginDTO dto) {
    // 1. code换取openid
    String openid = wxAuthService.getOpenid(dto.getCode());

    // 2. 查询或创建用户
    User user = userService.getOrCreateByOpenid(openid, dto);

    // 3. 加载角色和权限
    List<String> roles = roleService.getRoleCodesByUserId(user.getId());
    List<String> permissions = permissionService.getPermCodesByUserId(user.getId());

    // 4. 生成Token
    AccessToken token = new AccessToken();
    token.setUserId(user.getId());
    token.setTenantId(user.getTenantId());
    token.setRoles(roles);
    token.setPermissions(permissions);
    String jwt = tokenService.newToken(token);

    // 5. 查询小程序可访问的工具列表
    List<ToolListVO> tools = toolService.getAccessibleTools(user.getTenantId(), user.getId());

    // 6. 查询小程序页面配置
    MiniAppConfigVO config = menuService.getMiniAppConfig(roles);

    return R.ok(new MiniAppLoginVO(jwt, user, tools, config));
}
```

**小程序返回数据:**
```json
{
  "code": 200,
  "data": {
    "token": "eyJhbGc...",
    "userInfo": {
      "id": 456,
      "nickname": "微信用户",
      "avatar": "https://..."
    },
    "tools": [
      {
        "id": 10,
        "toolCode": "survey-2024",
        "toolName": "满意度调查",
        "toolIcon": "https://...",
        "category": "survey",
        "submitCount": 256
      }
    ],
    "config": {
      "tabBar": [
        {
          "pagePath": "pages/index/index",
          "text": "首页",
          "iconPath": "/static/home.png"
        },
        {
          "pagePath": "pages/tool/list",
          "text": "工具",
          "iconPath": "/static/tool.png"
        }
      ]
    }
  }
}
```

### 7.3 前端展示页面(工具访问)

```java
/**
 * 前端用户访问工具(无需登录)
 */
@GetMapping("/tool/public/{toolCode}")
public R<ToolDetailVO> getPublicTool(@PathVariable String toolCode,
                                      @RequestParam(required = false) String password) {
    // 1. 查询工具
    Tool tool = toolService.getByCode(toolCode);
    if (tool == null || tool.getStatus() != 1) {
        throw new BizException("工具不存在或已关闭");
    }

    // 2. 访问权限检查
    if (tool.getAccessType() == 2) { // 密码保护
        if (!MD5.verify(password, tool.getAccessPassword())) {
            throw new BizException("访问密码错误");
        }
    } else if (tool.getAccessType() == 3) { // 需要登录
        if (Access.userId() == null) {
            throw new BizException("请先登录");
        }
    }

    // 3. 增加访问次数
    tool.setViewCount(tool.getViewCount() + 1);
    toolService.updateById(tool);

    // 4. 解析配置JSON,返回表单结构
    ToolDetailVO vo = new ToolDetailVO();
    vo.setToolId(tool.getId());
    vo.setToolName(tool.getToolName());
    vo.setToolDesc(tool.getToolDesc());
    vo.setConfig(JSON.parseObject(tool.getConfigJson(), ToolConfigVO.class));
    vo.setStyle(JSON.parseObject(tool.getStyleJson(), ToolStyleVO.class));

    return R.ok(vo);
}
```

---

## 八、API接口设计

### 8.1 认证接口

```java
@RestController
@RequestMapping("/auth")
public class AuthController {

    /**
     * 管理后台登录
     */
    @PostMapping("/admin/login")
    public R<AdminLoginVO> adminLogin(@RequestBody @Validated AdminLoginDTO dto);

    /**
     * 小程序登录
     */
    @PostMapping("/miniapp/login")
    public R<MiniAppLoginVO> miniAppLogin(@RequestBody @Validated MiniAppLoginDTO dto);

    /**
     * 刷新Token
     */
    @PostMapping("/refresh")
    public R<String> refreshToken(@RequestHeader("Authorization") String token);

    /**
     * 登出
     */
    @PostMapping("/logout")
    public R<Void> logout();

    /**
     * 获取当前用户信息
     */
    @GetMapping("/userinfo")
    public R<UserInfoVO> getUserInfo();
}
```

### 8.2 租户管理接口(超级管理员)

```java
@RestController
@RequestMapping("/platform/tenant")
@PreAuthorize("hasRole('super_admin')")
public class PlatformTenantController {

    @GetMapping("/list")
    @PreAuthorize("hasAuthority('platform:tenant:list')")
    public R<IPage<TenantVO>> list(TenantQueryDTO query);

    @PostMapping("/add")
    @PreAuthorize("hasAuthority('platform:tenant:add')")
    public R<Void> add(@RequestBody @Validated TenantAddDTO dto);

    @PostMapping("/edit")
    @PreAuthorize("hasAuthority('platform:tenant:edit')")
    public R<Void> edit(@RequestBody @Validated TenantEditDTO dto);

    @PostMapping("/changeStatus")
    @PreAuthorize("hasAuthority('platform:tenant:status')")
    public R<Void> changeStatus(@RequestBody @Validated TenantStatusDTO dto);
}
```

### 8.3 工具管理接口

```java
@RestController
@RequestMapping("/tool")
public class ToolController {

    /**
     * 我的工具列表
     */
    @GetMapping("/my/list")
    @PreAuthorize("hasAnyAuthority('tool:create', 'tenant:tool:view')")
    public R<IPage<ToolVO>> myTools(ToolQueryDTO query) {
        // 查询当前用户创建的工具 + 协作的工具
        return R.ok(toolService.getMyTools(Access.userId(), query));
    }

    /**
     * 创建工具
     */
    @PostMapping("/create")
    @PreAuthorize("hasAuthority('tool:create')")
    public R<Long> create(@RequestBody @Validated ToolCreateDTO dto) {
        dto.setCreatorId(Access.userId());
        dto.setTenantId(Access.tenantId());
        return R.ok(toolService.create(dto));
    }

    /**
     * 编辑工具配置
     */
    @PostMapping("/config/edit")
    @RequireToolPermission(value = "toolId", permissions = {"owner", "editor"})
    public R<Void> editConfig(@RequestBody ToolConfigEditDTO dto);

    /**
     * 发布工具
     */
    @PostMapping("/publish")
    @RequireToolPermission(value = "toolId", permissions = {"owner"})
    public R<Void> publish(@RequestBody ToolPublishDTO dto);

    /**
     * 添加协作成员
     */
    @PostMapping("/member/add")
    @RequireToolPermission(value = "toolId", permissions = {"owner"})
    public R<Void> addMember(@RequestBody ToolMemberAddDTO dto);

    /**
     * 删除工具
     */
    @PostMapping("/delete")
    @RequireToolPermission(value = "toolId", permissions = {"owner"})
    public R<Void> delete(@RequestParam Long toolId);
}
```

### 8.4 数据管理接口

```java
@RestController
@RequestMapping("/data")
public class DataController {

    /**
     * 查询工具提交数据
     */
    @GetMapping("/list")
    @RequireToolPermission(value = "toolId", permissions = {"owner", "editor", "viewer"})
    public R<IPage<SubmissionVO>> list(@RequestParam Long toolId,
                                        SubmissionQueryDTO query) {
        return R.ok(submissionService.page(toolId, query));
    }

    /**
     * 查看数据详情
     */
    @GetMapping("/detail/{id}")
    @RequireToolPermission(value = "toolId", permissions = {"owner", "editor", "viewer"})
    public R<SubmissionDetailVO> detail(@PathVariable Long id,
                                         @RequestParam Long toolId) {
        return R.ok(submissionService.getDetail(id));
    }

    /**
     * 导出数据
     */
    @PostMapping("/export")
    @RequireToolPermission(value = "toolId", permissions = {"owner", "editor"})
    public void export(@RequestBody DataExportDTO dto, HttpServletResponse response) {
        submissionService.export(dto, response);
    }

    /**
     * 删除数据
     */
    @PostMapping("/delete")
    @RequireToolPermission(value = "toolId", permissions = {"owner"})
    public R<Void> delete(@RequestBody RemoveDTO dto);
}
```

### 8.5 模板市场接口

```java
@RestController
@RequestMapping("/template")
public class TemplateController {

    /**
     * 模板市场列表
     */
    @GetMapping("/market/list")
    public R<List<TemplateVO>> marketList(@RequestParam(required = false) String category) {
        // 查询全局模板 + 当前租户模板
        return R.ok(templateService.getMarketList(Access.tenantId(), category));
    }

    /**
     * 模板详情
     */
    @GetMapping("/detail/{id}")
    public R<TemplateDetailVO> detail(@PathVariable Long id);

    /**
     * 使用模板创建工具
     */
    @PostMapping("/use")
    @PreAuthorize("hasAuthority('tool:create')")
    public R<Long> useTemplate(@RequestBody TemplateUseDTO dto) {
        return R.ok(toolService.createFromTemplate(dto));
    }

    /**
     * 创建租户模板(保存为模板)
     */
    @PostMapping("/create")
    @PreAuthorize("hasAuthority('tenant:template:create')")
    public R<Void> create(@RequestBody TemplateCreateDTO dto);
}
```

---

## 九、实施步骤

### 9.1 数据库阶段

**步骤1: 创建Liquibase变更集**

```yaml
# src/main/resources/sql/changelog.yml
databaseChangeLog:
  - changeSet:
      id: 2026-01-02-create-xiaofeng-tables
      author: system
      changes:
        - sqlFile:
            path: sql/xiaofeng-schema.sql
            relativeToChangelogFile: true
        - sqlFile:
            path: sql/xiaofeng-init-data.sql
            relativeToChangelogFile: true
```

**步骤2: 执行迁移**

```bash
mvn clean compile
mvn liquibase:update
```

### 9.2 核心服务实现优先级

1. **TenantService** - 租户管理
2. **UserDetailsServiceImpl** - 用户加载和权限查询
3. **AuthService** - 登录逻辑(管理后台/小程序)
4. **ToolService** - 工具CRUD和权限检查
5. **TemplateService** - 模板管理
6. **SubmissionService** - 数据提交和查询
7. **MenuService** - 菜单树和动态配置

### 9.3 前端开发

**管理后台(Vue3 + Element Plus):**
1. 登录页和Token管理
2. 动态路由和菜单
3. 工具配置器(表单构建器)
4. 数据管理(表格、筛选、导出)
5. 统计看板

**前端展示页(纯HTML+JS或Vue):**
1. 动态表单渲染
2. 字段验证
3. 文件上传
4. 提交反馈

**小程序(uni-app):**
1. 微信授权登录
2. 工具列表和分类
3. 表单填写和提交
4. 我的提交记录

---

## 十、安全和性能

### 10.1 安全措施

1. **多租户隔离**: MyBatis-Plus租户拦截器自动添加租户ID过滤
2. **工具权限**: 基于t_tool_member表的细粒度权限控制
3. **数据加密**: 敏感字段加密存储
4. **审计日志**: 记录所有敏感操作
5. **XSS防护**: 用户提交数据进行HTML转义
6. **SQL注入防护**: 使用预编译,禁止拼接SQL
7. **文件上传安全**: 限制文件类型、大小,文件名随机化

### 10.2 性能优化

1. **Redis缓存**:
   - 用户权限缓存(TTL: 30分钟)
   - 菜单树缓存(TTL: 1小时)
   - 工具配置缓存(TTL: 10分钟)
   - Token缓存(TTL: Token过期时间)

2. **数据库优化**:
   - 租户ID索引
   - 工具ID索引
   - 联合索引优化
   - 分页查询

3. **CDN加速**: 静态资源和用户上传文件使用CDN

---

## 十一、总结

本设计文档基于晓风开发平台的业务需求,提供了完整的权限管理方案:

### 核心特点

1. **多租户架构**: 企业级数据隔离,支持SaaS化部署
2. **双层权限模型**: RBAC(系统级) + 工具级权限
3. **动态配置**: 所有菜单、页面、按钮由后端控制
4. **三端统一**: Web管理后台、前端展示、小程序权限联动
5. **灵活协作**: 工具级成员管理和权限分配

### 下一步工作

1. 创建数据库表和初始数据
2. 实现核心Service类
3. 开发Controller接口
4. 前端开发和联调
5. 测试和上线

---

**文档版本**: v2.0 (基于晓风开发平台PRD)
**创建日期**: 2026-01-01
**最后更新**: 2026-01-01
**作者**: 晓风开发团队
